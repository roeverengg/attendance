<script>
google.script.run.withSuccessHandler(res => {
  if (!res.allowed) {
    document.body.innerHTML = "<h3>Unauthorized Access</h3>";
  }
}).checkAdvisor();

function splitValues(val) {
  if (!val) return [];
  return val.split(",").map(v => v.trim()).filter(v => v.length === 3);
}

function submitAttendance() {
  const data = {
    date: document.getElementById("date").value,
    hour: document.getElementById("hour").value,
    absent: splitValues(document.getElementById("absent").value),
    od: splitValues(document.getElementById("od").value),
    others: splitValues(document.getElementById("others").value)
  };

  if (!data.date || !data.hour) {
    alert("Date and Hour required");
    return;
  }

  google.script.run.withSuccessHandler(msg => {
    document.getElementById("msg").innerText = msg;
  }).markAttendance(data);
}
</script>
